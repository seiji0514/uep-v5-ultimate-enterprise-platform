# UEP v5.0 セキュリティチェックリスト

**作成日**: 2026年2月19日  
**参照**: OWASP Top 10、実務レベルのセキュリティ要件

---

## OWASP Top 10 対応状況

| # | 脆弱性 | 確認項目 | 状態 | 備考 |
|---|--------|----------|------|------|
| A01 | インジェクション | SQLインジェクション対策（ORM使用、パラメータ化） | 要確認 | SQLAlchemy 使用 |
| A01 | インジェクション | コマンドインジェクション対策 | 要確認 | 外部コマンド実行の有無 |
| A02 | 認証の不備 | パスワードハッシュ（bcrypt等） | ✅ | passlib[bcrypt] 使用 |
| A02 | 認証の不備 | JWT の適切な設定（有効期限、アルゴリズム） | 要確認 | - |
| A02 | 認証の不備 | レート制限（ブルートフォース対策） | ✅ | slowapi 使用 |
| A03 | 機密データの露出 | ログにパスワード・トークンを出力しない | 要確認 | - |
| A03 | 機密データの露出 | HTTPS 強制（本番環境） | 要確認 | - |
| A04 | 安全でない設計 | 脅威モデリング | 要確認 | - |
| A05 | セキュリティ設定の不備 | デバッグモード無効（本番） | 要確認 | settings.DEBUG |
| A05 | セキュリティ設定の不備 | セキュリティヘッダー | ✅ | SecurityHeadersMiddleware |
| A06 | 脆弱なコンポーネント | 依存パッケージの脆弱性スキャン | 実施済（要対応あり） | 2026/2/19 pip-audit 実施 |
| A07 | 認証・セッションの不備 | セッション固定攻撃対策 | 要確認 | JWT 使用時 |
| A08 | データ整合性の不備 | 依存パッケージの改ざん検知 | 要確認 | - |
| A09 | ログ・監視の不備 | セキュリティイベントのログ記録 | 要確認 | 監査ログ |
| A10 | SSRF | 外部URLへのリクエスト制限 | 要確認 | - |

---

## 実施手順

### 1. 依存パッケージの脆弱性スキャン

```bash
# pip-audit のインストール（未導入の場合）
pip install pip-audit

# スキャン実行
pip-audit
```

### 2. セキュリティヘッダー確認

```bash
curl -I http://localhost:8000/
```

確認するヘッダー: X-Content-Type-Options, X-Frame-Options, Strict-Transport-Security 等

### 3. 認証・認可の確認

- 未認証で保護されたエンドポイントにアクセス → 401 が返ること
- 権限のないリソースにアクセス → 403 が返ること

---

## チェック実施記録

### pip-audit 実施記録（2026年2月19日）

| パッケージ | 現在バージョン | 修正版 | CVE |
|------------|----------------|--------|-----|
| werkzeug | 3.1.3 | 3.1.5 | CVE-2026-21860 |
| wheel | 0.44.0 | 0.46.2 | CVE-2026-24049 |
| yt-dlp | 2023.3.4 | 2024.7.1 以降 | 複数 |
| zipp | 3.17.0 | 3.19.1 | CVE-2024-5569 |

**スキップ**: Anaconda 由来パッケージ（conda, anaconda-navigator 等）は PyPI にないためスキップ。UEP の requirements.txt とは別。

**対応**: ローカル開発・デモ用途であれば即時対応は必須ではない。本番公開時は `pip install --upgrade werkzeug zipp wheel` 等で更新を推奨。

---

### チェック実施記録一覧

| 実施日 | 項目 | 結果 | 備考 |
|--------|------|------|------|
| 2026/2/19 | pip-audit | 脆弱性4件検出 | 上記参照 |
| | セキュリティヘッダー | 未実施 | curl -I で確認 |
| | 認証・認可 | 未実施 | 401/403 の確認 |

---

以上
